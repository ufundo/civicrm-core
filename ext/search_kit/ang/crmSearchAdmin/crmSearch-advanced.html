<div class="crm-search-admin-advanced crm-flex-box crm-flex-justify-between">
  <div class="crm-search-admin-advanced-lhs">
    <div class="crm-search-select-fields panel panel-info">
      <div class="panel-heading">
        <i class="crm-i fa-list-alt" role="img" aria-hidden="true"></i>
        {{:: ts('All Fields and Field Functions') }}
      </div>
      <div class="panel-body">
        <crm-search-admin-fields></crm-search-admin-fields>
      </div>
    </div>

    <div ng-if=":: $ctrl.paramExists('groupBy')" class="crm-search-groupbys panel panel-info">
      <div class="panel-heading">
        <i class="crm-i fa-arrow-up-wide-short" role="img" aria-hidden="true"></i>
        {{:: ts('Group By') }}
      </div>
      <div class="panel-body">
        <div class="form-inline" ng-repeat="groupBy in $ctrl.savedSearch.api_params.groupBy" class="crm-search-groupby">
          <label for="crm-search-groupBy-{{ $index }}">{{:: ts('Group By') }}</label>
          <crm-search-function class="form-group" expr="$ctrl.savedSearch.api_params.groupBy[$index]" mode="groupBy"></crm-search-function>
          <span ng-if="!$ctrl.hasFunction($ctrl.savedSearch.api_params.groupBy[$index])">
                <input id="crm-search-groupBy-{{ $index }}" class="form-control crm-auto-width" ng-model="$ctrl.savedSearch.api_params.groupBy[$index]" crm-ui-select="{placeholder: ' ', data: fieldsForGroupBy}" ng-change="changeGroupBy($index)" />
              </span>
          <hr>
        </div>
        <div class="form-inline crm-search-groupby-add">
          <input id="crm-search-add-groupBy"
                 class="form-control crm-action-menu fa-plus"
                 crm-ui-select="{placeholder: ts('Group By'), data: fieldsForGroupBy}"
                 on-crm-ui-select="$ctrl.addParam('groupBy', selection)" >
        </div>
      </div>
    </div>

    <div class="api4-clause-fieldset crm-search-havings panel panel-info">
      <div class="panel-heading">
        <i class="crm-i fa-filter" role="img" aria-hidden="true"></i>
        {{:: ts('Having') }}
      </div>
      <div class="panel-body">
        <crm-search-clause clauses="$ctrl.savedSearch.api_params.having" format="string" op="AND" label="{{:: ts('Having') }}" help="having" fields="fieldsForHaving" aliases="$ctrl.savedSearch.api_params.select" ></crm-search-clause>
      </div>
    </div>

    <div class="api4-clause-fieldset crm-search-without panel panel-info">
      <div class="panel-heading">
        <i class="crm-i fa-link-slash" role="img" aria-hidden="true"></i>
        {{:: ts('Without') }}
      </div>
      <div class="panel-body">
        <div ng-include="'~/crmSearchAdmin/crmSearch-without-joins.html'"></div>
      </div>
    </div>

    <div class="crm-search-expiry panel panel-info">
      <div class="panel-heading">{{:: ts('Other settings') }}</div>
      <div class="panel-body">
        <div class="form-group">
          <label>{{:: ts('Expires') }}</label>
          <i class="crm-i fa-calendar-times-o" role="img" aria-hidden="true"></i>
          <input id="expires_date" class="form-control" crm-ui-datepicker="{time: true}" ng-model="$ctrl.savedSearch.expires_date" >
        </div>
      </div>
    </div>
  </div>

  <div class="crm-search-admin-debug panel panel-info">
    <div class="panel-heading">{{:: ts('Query Info') }}</div>
    <div class="panel-body">
      <div ng-include="'~/crmSearchAdmin/crmSearch-query.html'"></div>
    </div>
    </div>
  </div>
</div>